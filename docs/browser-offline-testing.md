# Тестирование оффлайн-режима PWA в браузере

Это руководство поможет быстро и эффективно проверить работу Progressive Web App (PWA) в режиме офлайн непосредственно в браузере, без необходимости установки на устройство.

## Необходимые инструменты

- Google Chrome (рекомендуется версия 90+)
- Chrome DevTools (встроен в браузер, F12 или Ctrl+Shift+I)

## Пошаговая инструкция по тестированию

### Шаг 1: Загрузка приложения и проверка Service Worker

1. Откройте PWA в браузере Chrome по адресу вашего сайта
2. Откройте Chrome DevTools (F12)
3. Перейдите на вкладку **Application**
4. В левой панели выберите **Service Workers**
5. Убедитесь, что Service Worker отображается в списке и имеет статус **Activated** и **Running**

![Service Worker Status](../public/images/sw-status.png)

### Шаг 2: Проверка кэшированных ресурсов

1. В том же разделе DevTools перейдите в **Cache Storage**
2. Разверните кэш с именем `ai-store-v1` или похожим
3. Убедитесь, что в кэше присутствуют необходимые ресурсы:
   - index.html
   - offline.html
   - CSS-файлы
   - JavaScript-файлы
   - Иконки и основные изображения

![Cache Storage](../public/images/cache-storage.png)

### Шаг 3: Тестирование в оффлайн-режиме

1. Перейдите на вкладку **Network** в DevTools
2. Установите флажок **Offline** (это симулирует отсутствие интернет-соединения)
3. Обновите страницу (F5 или Ctrl+R)

![Network Offline Mode](../public/images/network-offline.png)

### Шаг 4: Проверка поведения в оффлайн-режиме

Проверьте следующие аспекты:

1. **Базовое отображение**: Загружается ли страница вместо стандартной страницы "нет подключения"?
2. **Навигация**: Работают ли навигационные элементы для кэшированных страниц?
3. **Стилизация**: Правильно ли отображаются стили и изображения?
4. **Оффлайн-уведомление**: Отображается ли уведомление о том, что пользователь находится в оффлайн-режиме?
5. **Отображение кэшированного контента**: Доступны ли данные, которые были загружены ранее?

![Offline Page](../public/images/offline-page.png)

### Шаг 5: Тестирование перехода в онлайн-режим

1. Снимите флажок **Offline** в DevTools
2. Наблюдайте за поведением приложения:
   - Обновляется ли контент автоматически?
   - Исчезает ли оффлайн-уведомление?
   - Восстанавливается ли полная функциональность?

### Шаг 6: Тестирование при медленном соединении

1. Вместо режима **Offline** выберите **Slow 3G** в выпадающем списке скорости сети
2. Обновите страницу и проверьте:
   - Как быстро загружаются страницы?
   - Показываются ли индикаторы загрузки?
   - Отображается ли контент постепенно или только после полной загрузки?

## Углубленное тестирование

### Проверка обновления Service Worker

1. Внесите изменения в какой-либо кэшированный ресурс (например, измените текст на главной странице)
2. Обновите версию кэша в service-worker.js (например, `const CACHE_NAME = 'ai-store-v2'`)
3. Перезагрузите страницу
4. В DevTools > Application > Service Workers проверьте:
   - Появился ли новый Service Worker
   - Произошло ли обновление кэша

### Тестирование Push-уведомлений (если реализовано)

1. В DevTools > Application > Service Workers нажмите на кнопку "Push"
2. Проверьте, появляется ли уведомление

### Проверка установки приложения

1. В адресной строке Chrome должна появиться иконка установки (+)
2. Нажмите на неё и выберите "Установить"
3. Проверьте запуск установленного PWA и его работу в оффлайн-режиме

## Контрольный список для проверки оффлайн-функциональности

- [ ] Service Worker успешно регистрируется и активируется
- [ ] Необходимые ресурсы кэшируются правильно
- [ ] Страница загружается в режиме офлайн
- [ ] Отображается уведомление о том, что пользователь находится в оффлайн-режиме
- [ ] Навигация работает для кэшированных страниц
- [ ] При попытке доступа к некэшированным ресурсам отображается оффлайн-страница
- [ ] При возвращении в онлайн-режим приложение восстанавливает полную функциональность
- [ ] Приложение работает стабильно при медленном соединении
- [ ] Service Worker корректно обновляется при изменении кэша
- [ ] PWA можно установить как отдельное приложение

## Решение проблем

### Проблема: Service Worker не активируется

**Решение**: 
- Проверьте наличие ошибок в консоли DevTools
- Убедитесь, что путь к service-worker.js указан корректно
- Проверьте, что service-worker.js обслуживается с правильными MIME-типами

### Проблема: Ресурсы не кэшируются

**Решение**:
- Проверьте пути к ресурсам в списке STATIC_ASSETS
- Убедитесь, что ресурсы доступны и не возвращают ошибки

### Проблема: Приложение не работает в оффлайн-режиме

**Решение**:
- Проверьте обработчик события fetch в service-worker.js
- Убедитесь, что offline.html включена в кэш
- Проверьте стратегию кэширования для различных типов запросов